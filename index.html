<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Bomber Pro - Full Effects & Credit</title>

<style>
*{ margin:0; padding:0; box-sizing:border-box; user-select:none; -webkit-tap-highlight-color: transparent; }

body{
    width:100vw; height:100vh;
    background: linear-gradient(135deg, #667eea 0%, #7e6789 100%);
    font-family: 'Segoe UI', Tahoma, sans-serif;
    display:flex; justify-content:center; align-items:center;
    flex-direction:column; overflow: hidden; touch-action: none;
    transition: background 0.5s ease-out;
}

/* Hi·ªáu ·ª©ng rung v√† ch·ªõp m√†u */
@keyframes intenseShake {
    0% { transform: translate(0,0); }
    10% { transform: translate(-10px, 10px); }
    30% { transform: translate(10px, -10px); }
    50% { transform: translate(-10px, 10px); }
    70% { transform: translate(10px, 10px); }
    100% { transform: translate(0,0); }
}
body.shake { animation: intenseShake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
body.flash-red { background: #ff4757 !important; transition: background 0s; }
body.flash-green { background: #2ecc71 !important; transition: background 0s; }

/* HEADER */
.header{
    position:fixed; top:0; left:0; right:0;
    display:flex; justify-content:space-between; align-items:center;
    padding:8px 15px; background:rgba(255,255,255,0.15);
    backdrop-filter:blur(10px); z-index:100;
}
#info { font-size: 15px; font-weight: 600; color: #fff; }
#hearts { font-size: 24px; }
#mainRestartBtn {
    background: rgba(255,255,255,0.2);
    border: 1px solid rgba(255,255,255,0.4);
    color: white;
    padding: 5px 12px;
    border-radius: 15px;
    font-size: 13px;
    font-weight: bold;
    cursor: pointer;
}

/* GRID */
.grid{
    display:grid; grid-template-columns:repeat(3,100px);
    gap:15px; padding:20px; z-index: 10;
}
.cell{
    width:100px; height:100px;
    background: url("https://i.supaimg.com/4eb5073b-65eb-4e00-89f1-31ca8714f7e7.png") center/cover no-repeat;
    border-radius:15px; cursor:pointer; display:flex;
    justify-content:center; align-items:center;
    box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
    position:relative; transition: opacity 0.4s;
}
.content{ 
    font-size:45px; pointer-events: none; 
    transition: opacity 0.3s, transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
}

/* CANVAS N·ªî */
#explosionCanvas {
    position: fixed; top: 0; left: 0; 
    width: 100%; height: 100%;
    pointer-events: none; z-index: 999;
}

/* POPUP */
#popup-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85); backdrop-filter: blur(12px);
    display: none; justify-content: center; align-items: center; z-index: 2000;
}
#popup-content { background: white; padding: 30px; border-radius: 25px; text-align: center; width: 300px; }
.popup-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white; border: none; padding: 15px; border-radius: 30px;
    font-weight: bold; margin-top: 20px; width: 100%; cursor: pointer;
}

.bottom-icons { 
    position: fixed; 
    bottom: 15px; 
    left: 15px; 
    display: flex; 
    gap: 5px; 
    align-items: center; 
}

.bottom-icons img { 
    width: 50px; 
    height: 50px; 
    object-fit: contain; 
    flex-shrink: 0;      
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3)); 
}

/* PH·∫¶N CREDIT M·ªöI TH√äM */
.credit {
    position: fixed;
    bottom: 15px;
    right: 15px;
    text-align: right;
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
    line-height: 1.4;
    z-index: 100;
}
.credit b { color: #fff; text-transform: uppercase; letter-spacing: 1px; }

@media (max-width: 600px) {
    .bottom-icons img { width:120px; height: 120px; }
    .cell { width: 85px; height: 85px; }
    .grid { grid-template-columns: repeat(3, 85px); gap: 5px; }
}

</style>
</head>
<body>

<div class="header">
    <div id="info">üí£ ƒê·∫∑t 3 qu·∫£ bom</div>
    <button id="mainRestartBtn" onclick="resetGame()">üîÑ Ch∆°i L·∫°i</button>
    <div id="hearts">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
</div>

<div class="grid" id="grid"></div>
<canvas id="explosionCanvas"></canvas>

<div id="popup-overlay">
    <div id="popup-content">
        <h1 id="p-title"></h1>
        <p id="p-msg" style="margin:10px 0; color:#555"></p>
        <button class="popup-btn" onclick="resetGame()">üîÑ CH∆†I V√ÅN M·ªöI</button>
    </div>
</div>

<div class="bottom-icons">
    <img src="https://i.supaimg.com/7a2dc5f9-23e1-4664-8044-bd920be029d3.png">
    <img src="https://i.supaimg.com/2d339766-77e9-4dfb-9730-5809e1ffbff8.png">
    <img src="https://i.supaimg.com/2cda8c22-8ffc-420b-b62e-7a7e41935cd0.png">
</div>

<div class="credit">
    <span>Ph√°t tri·ªÉn b·ªüi</span><br>
    <b>VTUONG</b>
</div>

<script>
// T·ªëi ∆∞u t·∫£i √¢m thanh ngay l·∫≠p t·ª©c
const sounds = {
    setBomb: new Audio("https://raw.githubusercontent.com/vtuong2104-hub/Sound/main/minecraft-explode1.mp3"),
    explode: new Audio("https://raw.githubusercontent.com/vtuong2104-hub/Sound/main/boomno.mp3"),
    safe: new Audio("https://raw.githubusercontent.com/vtuong2104-hub/Sound/main/antooan.mp3"),
    lose: new Audio("https://raw.githubusercontent.com/vtuong2104-hub/Sound/main/thua.mp3"),
    win: new Audio("https://raw.githubusercontent.com/vtuong2104-hub/Sound/main/th%E1%BA%AFng.mp3")
};

Object.values(sounds).forEach(audio => {
    audio.preload = "auto";
    audio.load();
});

function playSound(sound) {
    sound.currentTime = 0;
    sound.play().catch(() => {});
}

const canvas = document.getElementById('explosionCanvas');
const ctx = canvas.getContext('2d');
let particles = [];

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

class Particle {
    constructor(x, y, color) {
        this.x = x; this.y = y;
        this.color = color;
        this.size = Math.random() * 6 + 2;
        this.speedX = (Math.random() - 0.5) * 18;
        this.speedY = (Math.random() - 0.5) * 18;
        this.gravity = 0.15;
        this.opacity = 1;
    }
    update() {
        this.speedY += this.gravity;
        this.x += this.speedX;
        this.y += this.speedY;
        this.opacity -= 0.015;
    }
    draw() {
        ctx.save();
        ctx.globalAlpha = this.opacity;
        ctx.fillStyle = this.color;
        ctx.shadowBlur = 15; ctx.shadowColor = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
    }
}

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particles.forEach((p, i) => {
        p.update(); p.draw();
        if (p.opacity <= 0) particles.splice(i, 1);
    });
    requestAnimationFrame(animate);
}
animate();

function triggerExplode(x, y, isSafe) {
    const effectClass = isSafe ? 'flash-green' : 'flash-red';
    document.body.classList.add(effectClass, 'shake');
    setTimeout(() => document.body.classList.remove(effectClass, 'shake'), 600);

    const colors = isSafe ? ['#2ecc71', '#ffffff', '#a2f0bd'] : ['#ff4757', '#ffa502', '#ffff00', '#ffffff'];
    for (let i = 0; i < 45; i++) {
        particles.push(new Particle(x, y, colors[Math.floor(Math.random() * colors.length)]));
    }
}

let traps = [], phase = "set", hearts = 3, cleared = 0;
const grid = document.getElementById('grid');

function createGrid() {
    grid.innerHTML = ""; traps = []; phase = "set"; hearts = 3; cleared = 0;
    document.getElementById('hearts').textContent = "‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è";
    document.getElementById('info').textContent = "üí£ ƒê·∫∑t 3 qu·∫£ bom";
    document.getElementById('popup-overlay').style.display = 'none';
    
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        const content = document.createElement('div');
        content.className = 'content';
        cell.appendChild(content);

        cell.onclick = () => {
            if (cell.style.opacity === "0") return;
            const rect = cell.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;

            if (phase === "set") {
                if (traps.includes(i)) return;
                traps.push(i);
                playSound(sounds.setBomb);
                content.textContent = "üí£";
                if (traps.length === 3) {
                    phase = "play";
                    document.getElementById('info').textContent = "üéÆ T√¨m √¥ an to√†n!";
                    setTimeout(() => {
                        traps.forEach(t => {
                            const c = grid.children[t].firstChild;
                            c.style.opacity = "0";
                            setTimeout(() => c.textContent = "", 300);
                        });
                    }, 300);
                }
                return;
            }

            if (traps.includes(i)) {
                playSound(sounds.explode);
                triggerExplode(cx, cy, false);
                content.textContent = "üí£";
                content.style.opacity = "1";
                content.style.transform = "scale(3) rotate(15deg)";
                hearts--;
                document.getElementById('hearts').textContent = "‚ù§Ô∏è".repeat(hearts) || "üíÄ";
                if (hearts <= 0) setTimeout(() => finish(false), 700);
            } else {
                playSound(sounds.safe);
                triggerExplode(cx, cy, true);
                content.textContent = "‚úÖ";
                content.style.opacity = "1";
                content.style.transform = "scale(3)";
                cleared++;
                if (cleared === 6) setTimeout(() => finish(true), 700);
            }
            setTimeout(() => cell.style.opacity = "0", 450);
        };
        grid.appendChild(cell);
    }
}

function finish(win) {
    if (win) playSound(sounds.win); else playSound(sounds.lose);
    document.getElementById('p-title').textContent = win ? "TH·∫ÆNG L·ª¢I! üéâ" : "TH·∫§T B·∫†I! üíÄ";
    document.getElementById('p-title').style.color = win ? "#2ecc71" : "#ff4757";
    document.getElementById('p-msg').textContent = win ? "N√© bom qu√° ƒë·ªânh!" : "B·∫°n ƒë√£ tr√∫ng b·∫´y!";
    document.getElementById('popup-overlay').style.display = 'flex';
}

function resetGame() {
    createGrid();
}

createGrid();
</script>
</body>
</html>
